<!DOCTYPE html>
<html lang="en">

<head>
	<title>Dartmouth Runners</title>
	<meta charset="UTF-8">
	<meta name="description" content="Dartmouth Runners">
	<meta name="keywords" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Oswald:300,400,500,700|Roboto:300,400,700" rel="stylesheet"/>

	<!-- Favicons -->
	<link rel="apple-touch-icon" sizes="57x57" href="favicons/apple-icon-57x57.png"/>
	<link rel="apple-touch-icon" sizes="60x60" href="favicons/apple-icon-60x60.png"/>
	<link rel="apple-touch-icon" sizes="72x72" href="favicons/apple-icon-72x72.png"/>
	<link rel="apple-touch-icon" sizes="76x76" href="favicons/apple-icon-76x76.png"/>
	<link rel="apple-touch-icon" sizes="114x114" href="favicons/apple-icon-114x114.png"/>
	<link rel="apple-touch-icon" sizes="120x120" href="favicons/apple-icon-120x120.png"/>
	<link rel="apple-touch-icon" sizes="144x144" href="favicons/apple-icon-144x144.png"/>
	<link rel="apple-touch-icon" sizes="152x152" href="favicons/apple-icon-152x152.png"/>
	<link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-icon-180x180.png"/>
	<link rel="icon" type="image/png" sizes="96x96" href="favicons/favicon-96x96.png"/>
	<link rel="icon" type="image/png" sizes="16x16" href="favicons/favicon-16x16.png"/>
	<link rel="manifest" href="favicons/manifest.json"/>
	<meta name="msapplication-TileColor" content="#ffffff"/>
	<meta name="msapplication-TileImage" content="favicons/ms-icon-144x144.png"/>
	<meta name="apple-mobile-web-app-capable" content="yes">
	<script type="text/javascript">
        (function(document,navigator,standalone) {
            // prevents links from apps from oppening in mobile safari
            // this javascript must be the first script in your <head>
            if ((standalone in navigator) && navigator[standalone]) {
                var curnode, location=document.location, stop=/^(a|html)$/i;
                document.addEventListener('click', function(e) {
                    curnode=e.target;
                    while (!(stop).test(curnode.nodeName)) {
                        curnode=curnode.parentNode;
                    }
                    // Condidions to do this only on links to your own app
                    // if you want all links, use if('href' in curnode) instead.
                    if('href' in curnode && ( curnode.href.indexOf('http') || ~curnode.href.indexOf(location.host) ) ) {
                        e.preventDefault();
                        location.href = curnode.href;
                    }
                },false);
            }
        })(document,window.navigator,'standalone');
    </script>
	<meta name="theme-color" content="#ffffff"/>

	<!-- Stylesheets -->
	<link href="css/bootstrap.min.css" rel="stylesheet" />
	<link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet"/>
	<link href="strava/d3/css/tipsy.css" rel="stylesheet" />
	<link href="css/style.css" rel="stylesheet" />

	<!-- JS libraries -->
	<script src="js/jquery-2.1.4.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="strava/d3/js/jquery.tipsy.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.2/d3.min.js"></script>

	<!--[if lt IE 9]>
	  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

</head>

<body>
	<!-- Nav Bar -->
	<nav class="navbar navbar-default navbar-fixed-top">
	  <div class="container" style="width: 100%">
		 <div class"navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
			  <span class="sr-only">Toggle navigation</span>
			  <span class="icon-bar"></span>
			  <span class="icon-bar"></span>
			  <span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="index.html"><img src="img/dra-05-06.svg" height="50"/></a>
		 </div>
		 <div id="navbar" class="navbar-collapse collapse">
			<ul class="white-nav nav navbar-nav navbar-right">
			  <li><a href="index.html#about">About Us</a></li>
			  <li><a href="#schedule">Schedule</a></li>
			  <li><a href="faq.html">FAQ</a></li>
			  <li><a href="#contact">Contact</a></li>
			</ul>
		 </div>
	  </div>
	</nav>

	<!-- Schedule Section -->
	<a name="faq"></a>
	<div class="faq-section spad">
		<div class="faq-overlay"></div>
		<div class="container">
			<div class="section-title dark">
				<h2>This week's route</h2>
			</div>
			<div class="faq-info" style="padding-top: 25px">
				<h5 id="route-date"></h5>
				<h3 id="route-name"></h3>
				<p id="route-stats"></p>
			</div>
			<div class="map-container">
				<div id="map"></div>
			</div>
			<div class="faq-info">
				<p id="route-description"></p>
			</div>
			<div class="faq-info">
				<h3 id="strava-link" style="padding-top: 15px; padding-bottom: 25px"></h3>
			</div>
		</div>
	</div>

	<!-- Contact section -->
	<a name="contact"></a>
	<div class="contact-section spad fix">
		<div class="container">
			<div class="row">
				<div class="col-md-5 col-md-offset-1 contact-info col-push">
					<div class="section-title dark left">
						<h2>Contact Us</h2>
					</div>
					<p>
						Check out our <a href="faq.html">FAQ</a> page for more info on our weekly runs! <br />OR feel free to send us an email!
					</p>
					<div class="social-icons">
						<ul class="list-unstyled text-center mb-0">
							<li class="list-unstyled-item">
								<a href="mailto:dartmouthrunners@gmail.com">
					            <i class="far fa-envelope"></i>
				          	</a>
							</li>
							<li class="list-unstyled-item">
								<a href="https://www.instagram.com/dartmouthrunning/">
					            <i class="fab fa-instagram"></i>
				          	</a>
							</li>
							<li class="list-unstyled-item">
								<a href="https://www.strava.com/clubs/dartmouthrunners">
					            <i class="fab fa-strava"></i>
				          </a>
							</li>
						</ul>
					</div>


				</div>
				<div class="col-md-6 col-pull">
					<div class="carousel-container">
						<div id="instafeed-carousel" class="carousel slide" data-interval="5000" data-ride="carousel">
							<ol class="carousel-indicators">
								<li data-target="#instafeed-carousel" data-slide-to="0" class="active"></li>
								<li data-target="#instafeed-carousel" data-slide-to="1"></li>
								<li data-target="#instafeed-carousel" data-slide-to="2"></li>
								<li data-target="#instafeed-carousel" data-slide-to="3"></li>
							</ol>
							<div class="carousel-inner" id="instafeed"></div>
							<a class="carousel-control-prev" href="#instafeed-carousel" role="button" data-slide="prev">
								<span class="carousel-control-prev-icon" aria-hidden="true"></span>
							</a>
							<a class="carousel-control-next" href="#instafeed-carousel" role="button" data-slide="next">
								<span class="carousel-control-next-icon" aria-hidden="true"></span>
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<footer class="footer-section">
		<h2>2018 All rights reserved. Dartmouth Runners.</h2>
	</footer>

	<!-- Instafeed -->
	<script type="text/javascript" src="vendor/instafeed.js/instafeed.min.js"></script>
	<script type='text/javascript'>
		var feed = new Instafeed({
			get: "user",
			userId: 5689721276,
			accessToken: "5689721276.076fbee.38ef1f2b84c3415c86e20c9213700d72",
			limit: 4,
			sortBy: 'most-recent',
			template: '<div class="item"><a href="{{link}}" target="_blank"><img src="{{image}}" alt="{{caption}}"/></a></div>',
			resolution: "standard_resolution",
			after: function() {
				$('#instafeed > div:nth-child(1)').addClass('active');
			}
		});
		feed.run();
	</script>

	<script type="text/javascript">
		$.getJSON("strava/data/route_details.json", function(data) {
			// populate the date
			document.getElementById('route-date').innerHTML = data.date;

			// populate the route name
			document.getElementById('route-name').innerHTML = data.name;

			// route stats
			var dist = Math.round(10 * (data.distance/1000)) / 10;
			var elev = Math.round(data.elevation_gain);
			document.getElementById('route-stats').innerHTML = dist + 'km ' + '&nbsp;//&nbsp;&nbsp;' + elev + 'm elevation gain';

			// route description
			document.getElementById('route-description').innerHTML = data.description;

			// strava link
			document.getElementById('strava-link').innerHTML = 'Check out the route on <a href="https://www.strava.com/routes/' + data.id + '">Strava</a>';
		})
	</script>

	<!-- Google Maps -->
	<script async defer src="https://maps.googleapis.com/maps/api/js?libraries=geometry&key=AIzaSyAt6oregj7ztZZF2IUz2RvW6gPOMeJBd-A&callback=initMap">
	</script>
	<script>
		function initMap() {
			$.getJSON("strava/data/route_details.json", function(data) {

				var latlng = new google.maps.LatLng(44.673715, -63.563881);
				var options = {
					zoom: 12,
					center: latlng,
					mapTypeId: google.maps.MapTypeId.ROADMAP,
					disableDefaultUI: true,
					navigationControl: false,
					mapTypeControl: false
				}

				var map = new google.maps.Map(document.getElementById("map"), options);

				var decodedPath = google.maps.geometry.encoding.decodePath(data.polyline);
				var decodedLevels = decodeLevels("BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB");

				var polyline = new google.maps.Polyline({
					path: decodedPath,
					levels: decodedLevels,
					strokeColor: "#FF0000",
					strokeOpacity: 1.0,
					strokeWeight: 2,
					map: map
				});

				var infowindow = new google.maps.InfoWindow({
					content: 'Sullivan\'s Pond Gazebo'
				});
				var marker = new google.maps.Marker({
					position: latlng,
					map: map
				});
				infowindow.open(map, marker);

				google.maps.Polyline.prototype.getBounds = function() {
					var bounds = new google.maps.LatLngBounds();
					this.getPath().forEach(function(e) {
						bounds.extend(e);
					});
					return bounds;
				}

				map.fitBounds(polyline.getBounds());
			});
		}

		function decodeLevels(encodedLevelsString) {
			var decodedLevels = [];

			for (var i = 0; i < encodedLevelsString.length; ++i) {
				var level = encodedLevelsString.charCodeAt(i) - 63;
				decodedLevels.push(level);
			}
			return decodedLevels;
		}
	</script>

</body>

</html>
